"use strict";(()=>{var d="outfit:lastCoords",f="/api/outfit";function g(){let t=new URLSearchParams(location.search);return{lat:t.get("lat"),lon:t.get("lon")}}function p(){try{return JSON.parse(localStorage.getItem(d)||"null")}catch(t){return null}}function o(t,e){let a=document.getElementById(t);a&&(a.textContent=e)}async function w(){var l,i,c;let{lat:t,lon:e}=g();if(!t||!e){let n=p();n&&n.lat&&n.lon&&(t=String(n.lat),e=String(n.lon))}if(!t||!e){o("s","\u8ACB\u5148\u5230\u4E3B\u9801\u8A2D\u5B9A\u5EA7\u6A19"),o("m","\u2192 "+location.origin+"/");return}let a=`${f}?lat=${encodeURIComponent(t)}&lon=${encodeURIComponent(e)}`,r=await(await fetch(a)).json();if(!r.ok){o("s","\u67E5\u8A62\u5931\u6557"),o("m",r.error||"");return}o("s",((l=r.overall)==null?void 0:l.summary)||"\uFF08\u7121 summary\uFF09"),o("m",`${((i=r.place)==null?void 0:i.ctyName)||""}${((c=r.place)==null?void 0:c.townName)||""}  ${r.date}`);let m=(r.periods||[]).map(n=>{let u=n.rain===!0?"\u96E8":n.rain===!1?"":"\u96E8?";return`${n.label||n.time}\uFF1A${n.wear}${u?" \xB7 "+u:""}`});o("p",m.join("\uFF5C"))}w().catch(t=>{o("s","\u932F\u8AA4");let e=document.getElementById("m");e&&(e.textContent=String(t),e.className="row row-mini err")});function h(){let t=0,e=!1,a=70;window.addEventListener("touchstart",s=>{window.scrollY===0&&(t=s.touches[0].clientY,e=!0)},{passive:!0}),window.addEventListener("touchmove",s=>{if(!e)return;s.touches[0].clientY-t>a&&(e=!1,location.reload())},{passive:!0}),window.addEventListener("touchend",()=>{e=!1},{passive:!0})}h();})();
